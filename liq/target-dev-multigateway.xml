<project name="dev-multigateway" default="warning">
    <property name="deploy-dir" value="deploy/target/${ant.project.name}" />

    <target name="warning">
        <echo message="Please run top level build." />
    </target>
    
    <target name="deploy">
        <mkdir dir="${deploy-dir}" />
        <copy todir="${deploy-dir}">
            <fileset dir="lib/felix/1.4.1">
                <include name="bin/felix.jar" />
                <include name="conf/config.properties"/>
            </fileset>
        </copy>
        <copy todir="${deploy-dir}/bundle">
            <fileset dir="ext">
                <include name="javax.servlet.jar" />
                <include name="org.osgi.compendium.jar" /> 
                <include name="osgi.mobile.jar" />
                <include name="org.apache.felix.dependencymanager.jar" /> 
            </fileset>
            <fileset dir="deploy/bundle">
            	<include name="net.luminis.liq.configurator-1.0.0.jar" />
                <include name="net.luminis.liq.scheduler-1.0.0.jar" />
                <include name="net.luminis.liq.deployment-1.0.0.jar" />
                <include name="net.luminis.liq.deployment.task-1.0.0.jar" />
                <include name="net.luminis.liq.identification.property-1.0.0.jar" />
                <include name="net.luminis.liq.discovery.property-1.0.0.jar" />
				<include name="net.luminis.liq.log.listener-1.0.0.jar" />           
                <include name="net.luminis.liq.log-1.0.0.jar" />
                <include name="net.luminis.liq.gateway.log.store-1.0.0.jar" />
            	<include name="net.luminis.liq.gateway.log-1.0.0.jar" />
            </fileset>
            <fileset dir="deploy/test">
                <include name="net.luminis.liq.consolelogger-1.0.0.jar" />
            </fileset>
            <fileset dir="lib">
                <include name="org.apache.felix.configadmin.jar" />
                <include name="org.apache.felix.eventadmin.jar" />
                <include name="net.luminis.liq.gateway.deploymentadmin-1.0.0.jar" />
            </fileset>
        </copy>
        <copy todir="${deploy-dir}/conf">
            <fileset dir="conf/${ant.project.name}">
                <include name="**/*.cfg" />
            </fileset>
        </copy>
        <replace file="${deploy-dir}/conf/config.properties" token="@bundles@" value=""/>
        <copy file="lib/run-multigateways.sh" tofile="${deploy-dir}/run.sh"/>
    </target>
</project>